<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <style>
    /* Строго одна страница A6, без внешних полей — фон занимает всю страницу */
    @page { size: 105mm 148mm; margin: 0; }
    html, body { margin:0; padding:0; width:100%; height:100%; }
    body { font-family: DejaVu Sans, sans-serif; color:#fff; }

    /* Фон подложен CSS-свойством, чтобы mPDF не добавлял лишние страницы */
    .sheet {
      width: 105mm; height: 148mm;
      background-image: url("{{bg_src}}");
      background-size: cover;            /* Заполняем всю страницу */
      background-repeat: no-repeat;
      background-position: center center;
      /* Небольшой fallback-цвет, если вдруг фон не загрузится */
      background-color: #0f3950;
    }

    /* Весь контент внутри одной колонки, без flex/absolute — безопасно для mPDF */
    .wrap { box-sizing: border-box; padding: 10mm 9mm 9mm 9mm; width: 105mm; height: 148mm; }

    .badge {
      display:inline-block; padding: 4px 10px; border-radius: 999px;
      background: rgba(255,255,255,0.16); border: 0.4pt solid rgba(255,255,255,0.3);
      color:#fff; font-weight:700; font-size:10.5pt; letter-spacing:.04em;
      text-shadow: 0 1px 6px #033a60a0;
    }

    .title {
      margin: 7mm 0 2mm 0;
      font-weight:700; font-size:18pt; letter-spacing:.03em; text-transform:uppercase; line-height:1.15;
      color:#fff; text-shadow: 0 2px 10px #033a60b0;
      word-break: break-word; white-space: normal;
    }

    .subtitle {
      color:#e2f6ff; font-size:10.2pt; margin-bottom: 7mm;
      text-shadow:0 1px 8px #033a6088;
    }
    .mono { font-family: DejaVu Sans Mono, monospace; letter-spacing:.02em; color:#d5f3ff; }

    /* Информационный блок — полупрозрачная плашка для читаемости */
    .info {
      background: rgba(8, 26, 46, 0.75);
      border-radius: 8px;
      padding: 5mm 6mm;
      color:#e4f7ff;
    }
    table.grid { width:100%; border-collapse:separate; border-spacing:0 2mm; table-layout:fixed; }
    td.key { width:38%; color:#bfe8f2; font-size:9pt; text-transform:uppercase; letter-spacing:.04em; font-weight:600; vertical-align:top; }
    td.val { width:62%; color:#fff;   font-size:12pt; font-weight:700; vertical-align:top; word-break:break-word; }

    /* QR-блок: белый QR (модули белые, фон прозрачный) на тёмной плашке */
    .qr-wrap { margin-top: 6mm; text-align:center; }
    .qr-plate {
      display:inline-block; background: rgba(8,26,46,0.90);
      border-radius: 8px; padding: 4.5mm 5mm;
      /* Тени аккуратные, но мягкие — mPDF их умеет */
      box-shadow: 0 2px 12px #001a2f66;
    }
    .qr-title { color:#cfeef5; font-size:10.2pt; font-weight:600; margin-bottom: 2mm; }
    .qr-img { width: 38mm; height: 38mm; display:block; }

    .note { color:#cde9f1; font-size:9.6pt; margin-top: 2.5mm; }

    .foot {
      margin-top: 7mm;
      color:#d6f0fa; font-size:9pt; border-top:0.3pt solid rgba(255,255,255,0.25);
      padding-top:4mm; line-height:1.22; text-align:center;
      text-shadow: 0 1px 6px #033a6060;
      word-break: break-word;
    }

    a.link { color:#8be3ff; text-decoration:none; border-bottom:0.3pt dotted #8be3ff; word-break:break-all; }
  </style>
</head>
<body>
  <div class="sheet">
    <div class="wrap">
      <span class="badge">Абонемент ДВВС</span>
      <div class="title">{{service_name}}</div>
      <div class="subtitle">Документ: <span class="mono">{{docId}}</span> · Дата: {{date}}</div>

      <div class="info">
        <table class="grid" role="presentation" cellspacing="0" cellpadding="0">
          <tr><td class="key">Стоимость</td><td class="val">{{price}} ₽</td></tr>
          <tr><td class="key">Посещений</td><td class="val">{{visits}}</td></tr>
          <tr><td class="key">Заморозка</td><td class="val">{{freezing}} дней</td></tr>
          <tr><td class="key">Телефон</td><td class="val">{{phone}}</td></tr>
          <tr><td class="key">E‑mail</td><td class="val">{{email}}</td></tr>
          <tr><td class="key">Ссылка ваучера</td><td class="val"><a class="link" href="{{voucher_url}}">{{voucher_url}}</a></td></tr>
        </table>

        <div class="qr-wrap">
          <div class="qr-title">QR‑КОД ПОДТВЕРЖДЕНИЯ</div>
          <div class="qr-plate">
            <img class="qr-img" src="{{qr_code_data}}" alt="QR-code"/>
          </div>
          <div class="note">Покажите этот код на стойке администратора. По QR подтверждается право на услугу.</div>
        </div>
      </div>

      <div class="foot">
        Настоящий абонемент является электронным документом, сформированным автоматически.<br/>
        Данные держателя: телефон {{phone}}, e‑mail {{email}}.<br/>
        Документ № <span class="mono">{{docId}}</span>.
      </div>
    </div>
  </div>
</body>
</html>